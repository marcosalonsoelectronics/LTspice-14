Version 4
SHEET 1 2008 1268
WIRE -336 -640 -544 -640
WIRE -128 -640 -336 -640
WIRE -128 -576 -128 -640
WIRE -336 -496 -400 -496
WIRE -208 -496 -272 -496
WIRE -176 -496 -208 -496
WIRE -304 -432 -304 -480
WIRE -192 -432 -304 -432
WIRE -128 -432 -128 -480
WIRE -128 -432 -192 -432
WIRE -544 -416 -544 -640
WIRE -128 -304 -128 -432
WIRE 32 -304 -128 -304
WIRE 320 -304 112 -304
WIRE 416 -304 320 -304
WIRE 480 -304 416 -304
WIRE 592 -304 480 -304
WIRE 1008 -304 656 -304
WIRE 1088 -304 1008 -304
WIRE 1376 -304 1280 -304
WIRE 1520 -304 1376 -304
WIRE 320 -240 320 -304
WIRE 480 -240 480 -304
WIRE -128 -224 -128 -304
WIRE 320 -112 320 -176
WIRE 400 -112 320 -112
WIRE 480 -112 480 -160
WIRE 480 -112 400 -112
WIRE 1184 -112 1184 -240
WIRE 1184 -112 912 -112
WIRE 1232 -112 1184 -112
WIRE -544 -96 -544 -336
WIRE -128 -96 -128 -160
WIRE 400 -96 400 -112
WIRE 176 176 80 176
WIRE 432 176 368 176
WIRE 480 176 432 176
WIRE -304 208 -320 208
WIRE -256 208 -304 208
WIRE 1520 208 1520 -304
WIRE -400 240 -400 -496
WIRE -304 240 -400 240
WIRE -256 240 -304 240
WIRE 800 240 608 240
WIRE 1008 240 864 240
WIRE 1088 240 1008 240
WIRE 1328 240 1280 240
WIRE 1392 240 1328 240
WIRE 1488 240 1392 240
WIRE 1696 240 1552 240
WIRE -16 272 -112 272
WIRE 80 272 80 176
WIRE 80 272 -16 272
WIRE 272 304 272 240
WIRE 272 304 240 304
WIRE 480 336 480 176
WIRE 80 368 80 272
WIRE 448 368 80 368
WIRE 608 368 608 240
WIRE 608 368 512 368
WIRE 1184 368 1184 304
WIRE 1184 368 1152 368
WIRE 480 480 480 400
WIRE 800 480 480 480
WIRE 1328 480 1328 240
WIRE 1328 480 864 480
FLAG -544 -96 0
FLAG 400 -96 0
FLAG 416 -304 out
FLAG -128 -96 0
FLAG -336 -640 dc
FLAG -208 -496 gate
FLAG -192 -432 source
FLAG 1008 -304 vsense
FLAG 1376 -304 out_n
FLAG -304 240 pwm
FLAG 1392 240 err_n
FLAG 1152 368 CLK
IOPIN 1152 368 In
FLAG 1008 240 err_n-1
FLAG 240 304 CLK
IOPIN 240 304 In
FLAG -16 272 yreg_n
FLAG 432 176 yreg_n-1
FLAG 1232 -112 CLK
IOPIN 1232 -112 Out
FLAG -304 208 sw
SYMBOL voltage -544 -432 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V1
SYMATTR Value 10
SYMBOL nmos -176 -576 R0
SYMATTR InstName M1
SYMATTR Value IRFZ48N
SYMBOL schottky -112 -160 R180
WINDOW 0 88 53 Left 2
WINDOW 3 55 22 Left 2
SYMATTR InstName D1
SYMATTR Value MBR735
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL cap 304 -240 R0
WINDOW 0 -57 7 Left 2
WINDOW 3 -60 42 Left 2
SYMATTR InstName C1
SYMATTR Value 10µ
SYMATTR SpiceLine Rser=0.15
SYMBOL res 464 -256 R0
SYMATTR InstName R8
SYMATTR Value 1
SYMBOL ind2 16 -288 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value 50µ
SYMATTR Type ind
SYMATTR SpiceLine Rser=0.05
SYMBOL Control\\driver -304 -496 R0
WINDOW 3 32 41 Bottom 2
SYMATTR Value k=15
SYMATTR InstName U1
SYMBOL Control\\gain 624 -304 R0
WINDOW 3 -3 77 Bottom 2
SYMATTR Value A=0.5
SYMATTR InstName U5
SYMBOL Control\\adc 1184 -368 R0
WINDOW 3 28 149 Left 2
WINDOW 123 35 180 Left 2
WINDOW 39 37 213 Left 2
SYMATTR InstName U6
SYMBOL Control\\clk 880 -112 R0
WINDOW 3 0 79 Bottom 2
WINDOW 123 5 110 Bottom 2
WINDOW 39 8 146 Bottom 2
SYMATTR Value2 SR=1e8 ton={0.2*Tsp}
SYMATTR SpiceLine f={1/Tsp}
SYMATTR InstName U7
SYMBOL Control\\dpwm -160 224 M0
WINDOW 3 24 107 Bottom 2
WINDOW 123 24 138 Bottom 2
WINDOW 39 22 166 Bottom 2
SYMATTR Value f=200k nbits=8
SYMATTR InstName U11
SYMBOL Control\\constant 1728 240 M0
WINDOW 3 -13 72 Bottom 2
SYMATTR Value K=128
SYMATTR InstName U3
SYMBOL Control\\ddelay 1184 176 M0
WINDOW 3 -110 145 Left 2
SYMATTR InstName U4
SYMBOL Control\\gain 832 240 M0
WINDOW 3 1 79 Bottom 2
SYMATTR Value A={-(1/tau_i)*(tau_z - 0.5*Tsp)}
SYMATTR InstName U8
SYMBOL Control\\gain 832 480 M0
WINDOW 3 -2 71 Bottom 2
SYMATTR Value A={(1/tau_i)*(tau_z + 0.5*Tsp)}
SYMATTR InstName U9
SYMBOL Control\\adder3 480 368 R180
WINDOW 0 -41 51 Bottom 2
SYMATTR InstName U10
SYMBOL Control\\ddelay 272 112 R0
WINDOW 3 19 149 Left 2
SYMATTR InstName U13
SYMBOL Control\\sub2 1520 240 R180
SYMATTR InstName U12
TEXT 152 -512 Left 2 !.tran 400u uic
TEXT 192 -168 Left 2 ;ESR=0.15
TEXT 24 -256 Left 2 ;DCR=0.05
TEXT 792 -200 Left 2 !.param Tsp=1u
TEXT 144 -464 Left 2 !.options reltol 1
TEXT 480 -512 Left 2 !.param tau_z 2.24e-5\n.param tau_i 2.24e-5
